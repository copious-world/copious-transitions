<div id="contactModal" class="modal">
	<!-- Modal content -->
	<div class="modal-content">
		<div class="modal-header">
			<span id="contactModalCloser" class="close">&times;</span>
			<h3><i>Captcha</i> : I am not a robot</h3>
		</div>
		<div class="modal-body">
			<div id="captcha-goes-here" style="border:1px solid lime;margin:2px;" >
				------
			</div>
			<div id="captcha-entry" >
				Type in the text that you see above:
				<input type="text" id="captcha-field" class="svgFormTextField" style="font-size:14px;margin-top:1px;margin-left:2px;border:1px solid black;"/>
			</div>
		</div>
		<div class="modal-footer">
			<button onclick="captchaCheck()">submit</button>
		</div>
	</div>
</div>

<div id="myContactForm" style="padding-left:10%;padding-top:8px;padding-bottom:8px" >
	<div class="error-message" id="contact-errors_here" >no error</div>
	<div class="form_el" >
		<label for='contact-cid' class='name'>Interplanetary Contact CID<span> (required)</span></label>
		<input type='text' name='contact-cid' id='contact-cid' value='' class='field_el name' style="width: 100%;" required onkeyup="onkey_checkContactError('contact-cid')" />
		<div class="form_el"  style="width: 100%;"  >
			Don't have an Interplanetary Contact identity?
			<br>
			<a href="https://www.copious.world/interplanetary-contact" target="_blank">Follow this link and make one.</a>
		</div>
	</div>
	<div class="form_el" >
		<label for='contact-website' class='url'>Website<span> (optional)</span></label>
		<input type='text' name='contact-website' id='contact-website' value='' class='field_el url' style="width: 100%;" onkeyup="onkey_checkContactError('contact-website')"  />
	</div>
	<div class="form_el" style="vertical-align:top">
		<label for='contact-comment' class='grunion-field-label textarea'>Comment<span>(required)</span></label><br>
		<textarea name='contact-comment' id='contact-comment' rows='10' class='textarea_field_el'  required onkeyup="onkey_checkContactError('contact-comment')"  ></textarea>
	</div>
	<p class='contact-submit'>
	<button onclick="processContact()" >Submit</button>
	</p>
	<div class="form_el" style="height:20px;background-color:rgb(230,230,240,0.4);font-style: oblique;font-weight: bold;color:rgba(242, 242, 210, 0.3);">
		copious contact (thank you for your interest and concerns)
	</div>
</div>

<script>

	// CONTACT APPLICATION
	var g_contact_Handling = null
	function initContact() {
		g_contact_Handling = new ValidationContainer({
			"auth_port" : "",
            "service_url" : `${location.protocol}//${g_siteURL}/{{auth_path}}/transition/contact`,
            "errors_here" : document.getElementById('contact-errors_here'),
            "failure_msg_prefix" : "Cannot Process Captcha",
			"fields" : {
				"cid" : document.getElementById('contact-cid'),
				"website" : document.querySelector('#contact-website'),
				"comment" : document.querySelector('#contact-comment')
			},
			"checks" : {
				"is_empty" : ["cid","comment"]
			},
			"modal" : document.querySelector('#contactModal'),
			"closer" : document.querySelector('#contactModalCloser'),
			"form" : document.querySelector('#myContactForm'),
			"captcha" : document.querySelector('#captcha-goes-here'),
			"captcha_field" : document.querySelector("#captcha-field"),
			"plain_text_color" : DEFAULT_PLAIN_TEXT_COLOR,
			"error_text_color" : DEFAULT_ERROR_TEXT_COLOR
		})
		g_CurContainer = g_contact_Handling; // has to be initlialized in the function
	}

	function contact_calcAppDataDB() {
		//
		let c_cid = g_contact_Handling.fields["cid"]
		let c_website = g_contact_Handling.fields["website"]
		let c_comment = g_contact_Handling.fields["comment"]
		//
		let data = {
			"cid" : getVal(c_cid),
			"website" : getVal(c_website),
			"comment" : getVal(c_comment),
			'token' : g_currenCaptchaTOKEN
		}
		//
		return(data)
	}

	function contact_completionaAction() {
		unpin_current();
		show_thankyou_box("Thank you for your message");
	}
	
	function processContact() {
		processUI_captchaService( g_contact_Handling,
									contact_calcAppDataDB,
									contact_completionaAction )
	}

	function onkey_checkContactError(srcField) {
	   if ( g_contact_Handling.checkFormValid() ) {
		   let focusFld = '#' + srcField;
		   let focusEl = document.querySelector(focusFld);
		   focusEl.style.borderColor = 'black'
		   g_contact_Handling.hideFormErrorMessage()
	   }
	}

	g_finalizers.push(initContact)

</script>